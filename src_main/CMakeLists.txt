#
#
# Main target

vala_precompile(MY_PROJECT_MAIN_SOURCES
	main.vala
PACKAGES
	gio-2.0
	gee-0.8
	posix
CUSTOM_VAPIS
    ${CMAKE_BINARY_DIR}/${LIBRAR_PATH}/${MY_PROJECT_HEADER}.vapi)

add_executable(${PROJECT_NAME}
	${MY_PROJECT_MAIN_SOURCES}
)

set_target_properties(${PROJECT_NAME} PROPERTIES
	INCLUDE_DIRECTORIES ${CMAKE_BINARY_DIR}/${LIBRAR_PATH})

target_link_libraries(${PROJECT_NAME} ${MY_PROJECT_LIBRARY_NAME} -lm)

install (TARGETS ${PROJECT_NAME}
  RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR})

# Generate a .gitignore
file(WRITE  ".gitignore" "# Automatically generated by CMake, do not modify.\n")
foreach(file
    ".gitignore"
    "${PROJECT_NAME}${CMAKE_EXECUTABLE_SUFFIX}")
  file(APPEND ".gitignore" "/${file}\n")
endforeach(file)
foreach(file ${MY_PROJECT_MAIN_SOURCES})
  string(REPLACE "${CMAKE_CURRENT_BINARY_DIR}/" "" file ${file})
  file(APPEND ".gitignore" "/${file}\n")
endforeach(file)
