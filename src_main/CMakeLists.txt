#
#
# Main target

vala_precompile(MY_PROJECT_MAIN_SOURCES
	main.vala
PACKAGES
	gio-2.0
	gee-0.8
	posix
CUSTOM_VAPIS
	${CMAKE_BINARY_DIR}/src_lib/my-project-${MY_PROJECT_VERSION_API}.vapi
OPTIONS
	${MY_PROJECT_VALA_FLAGS}
)

add_executable(my-project
	${MY_PROJECT_MAIN_SOURCES}
)

set_target_properties(my-project PROPERTIES
	INCLUDE_DIRECTORIES ${CMAKE_BINARY_DIR}/src_lib)

target_link_libraries(my-project my-project-${MY_PROJECT_VERSION_API} -lm)

install (TARGETS my-project
  RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR})

# Generate a .gitignore
file(WRITE  ".gitignore" "# Automatically generated by CMake, do not modify.\n")
foreach(file
    ".gitignore"
    "my-project${CMAKE_EXECUTABLE_SUFFIX}")
  file(APPEND ".gitignore" "/${file}\n")
endforeach(file)
foreach(file ${MY_PROJECT_MAIN_SOURCES})
  string(REPLACE "${CMAKE_CURRENT_BINARY_DIR}/" "" file ${file})
  file(APPEND ".gitignore" "/${file}\n")
endforeach(file)
